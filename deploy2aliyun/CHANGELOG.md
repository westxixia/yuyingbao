# 📝 部署脚本更新日志

## [v0.6.0] - 2024-09-30

### ✨ 新增功能

#### 智能部署模式 🤖
- **新增命令**：`./02_deploy-ecs.sh` 或 `./02_deploy-ecs.sh deploy`
- **智能检测**：自动检测现有部署状态
- **用户选择**：提供升级部署/全新部署/取消操作三个选项
- **首次部署**：无现有容器时自动执行全新部署

#### 升级部署模式 📈
- **新增命令**：`./02_deploy-ecs.sh upgrade`
- **数据安全**：完全保留PostgreSQL数据库数据
- **零停机更新**：数据库持续运行，仅重启应用容器
- **智能检测**：检查镜像更新和容器状态
- **自动诊断**：网络连接问题自动检测修复
- **可选清理**：升级完成后可选择清理旧镜像

#### 全新部署模式 🆕
- **新增命令**：`./02_deploy-ecs.sh fresh`
- **安全确认**：需要用户明确确认操作
- **完全重置**：删除所有现有容器和数据

### 🔧 脚本增强

#### 核心函数
- `smart_deploy()` - 智能部署选择逻辑
- `upgrade_application()` - 升级部署核心功能
- `full_deploy()` - 重构的完整部署功能

#### 帮助系统
- 更新 `show_help()` 函数，包含所有新命令说明
- 新增部署模式说明和使用示例
- emoji 图标增强可读性

#### 安全特性
- 升级部署过程中数据库数据完全保护
- 危险操作需用户明确确认
- 详细的状态检查和错误恢复

### 📖 文档优化

#### 02_DEPLOY_GUIDE.md 更新
- **脚本功能**：新增智能部署和升级部署功能说明
- **使用方法**：详细的三种部署模式说明
- **故障排除**：新增升级部署相关问题解决方案
- **维护操作**：简化日常升级流程说明
- **部署检查清单**：分别提供首次部署和升级部署检查清单
- **最佳实践**：智能部署优先的部署策略建议

#### 文档结构优化
- 遵循文档结构规范，保持内容简洁
- 删除重复内容，避免信息冗余
- 合并升级部署相关内容到主文档

### 🎯 使用场景

#### 推荐使用方式
```bash
# 日常使用（推荐）- 智能选择最佳部署模式
./02_deploy-ecs.sh

# 日常更新 - 保留数据的升级部署
./02_deploy-ecs.sh upgrade

# 重大变更 - 全新部署（需先备份数据）
./02_deploy-ecs.sh fresh
```

### ✅ 兼容性

- **向后兼容**：现有部署命令仍然有效
- **无缝升级**：现有部署可直接使用新的升级功能
- **多系统支持**：支持CentOS、Ubuntu等主流Linux发行版

### 🛡️ 安全措施

- 升级部署完全保留数据库数据
- 全新部署需要用户明确确认
- 详细的操作日志和错误信息
- 网络问题自动诊断和修复

---

## [v0.5.0] - 之前版本

### 基础功能
- Docker 环境自动安装配置
- PostgreSQL 数据库容器部署
- Spring Boot 应用容器部署
- 防火墙配置
- 健康检查

---

**维护者**：育婴宝开发团队  
**更新日期**：2024-09-30